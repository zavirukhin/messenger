<ng-container *transloco="let t;">
  <div class="settings-container">
    <div class="user-info">
      <tui-avatar
        size="xxl"
        [tuiSkeleton]="isLoading()"
        [src]="(profile()?.avatar_base64 ?? '') | tuiFallbackSrc: '@tui.user' | async"
      />
      <h1
        class="username-container"
        tuiTitle="m"
        [tuiSkeleton]="isLoading()"
      >
        {{ profile()?.last_name }} {{ profile()?.first_name }}
        @if (profile()?.custom_name) {
          <div tuiSubtitle>&#64;{{ profile()?.custom_name }}</div>
        }
        @else {
          <div tuiSubtitle>&#64;id{{ profile()?.id }}</div>
        }
      </h1>
    </div>
    <form
      (ngSubmit)="onSubmit()"
      [formGroup]="form"
      class="form-container"
    >
      <div class="input-container">
        <div>
          <tui-textfield
            tuiTextfieldSize="l"
            [tuiSkeleton]="isLoading()"
          >
            <label tuiLabel>{{ t('messenger.lastName') }}</label>
            <input
              formControlName="lastName"
              maxLength="50"
              tuiTextfield
            />
          </tui-textfield>
          <tui-error
            formControlName="lastName"
            [error]="[] | tuiFieldError | async"
          />
        </div>
        <div>
          <tui-textfield
            tuiTextfieldSize="l"
            [tuiSkeleton]="isLoading()"
          >
            <label tuiLabel>{{ t('messenger.firstName') }}</label>
            <input
              formControlName="firstName"
              maxLength="50"
              tuiTextfield
            />
          </tui-textfield>
          <tui-error
            formControlName="firstName"
            [error]="[] | tuiFieldError | async"
          />
        </div>
        <div>
          <tui-textfield
            tuiTextfieldSize="l"
            [tuiSkeleton]="isLoading()"
          >
            <label tuiLabel>{{ t('messenger.customName') }}</label>
            <input
              formControlName="customName"
              maxLength="50"
              tuiTextfield
            />
          </tui-textfield>
          <tui-error
            formControlName="customName"
            [error]="[] | tuiFieldError | async"
          />
        </div>
      </div>
      <div class="button-container">
        <button
          size="m"
          tuiButton
          type="button"
          [tuiSkeleton]="isLoading()"
          (click)="logout()"
        >
          {{ t('messenger.logout') }}
        </button>
        <button
          size="m"
          tuiButton
          [tuiSkeleton]="isLoading()"
          [disabled]="form.disabled"
          type="submit"
        >
          {{ t('messenger.change') }}
        </button>
      </div>
    </form>
  </div>
</ng-container>